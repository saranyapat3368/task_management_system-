{% extends "layout.html" %}
{% block title %}{% if library_mode %}‡∏Ñ‡∏•‡∏±‡∏á‡πÇ‡∏ô‡πâ‡∏ï{% else %}Dashboard{% endif %}{% endblock %}

{% block content %}

{% if not library_mode %}
<div class="top-search">
  <form class="top-search__form" method="get" action="{{ url_for('dashboard') }}">
    <input type="text" name="q" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏ô‡πä‡∏ï..." value="{{ q or '' }}">
    <select name="category">
      <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤</option>
      {% for c in categories %}
      <option value="{{ c }}" {% if cat==c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>
    <button class="btn blue" type="submit">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
  </form>
</div>
{% endif %}

<h2 class="page-title">{% if library_mode %}‡∏Ñ‡∏•‡∏±‡∏á‡πÇ‡∏ô‡πâ‡∏ï‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô{% else %}‡πÇ‡∏ô‡πä‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î{% endif %}</h2>

<div class="note-grid">
  {# ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ notes ‡πÄ‡∏õ‡πá‡∏ô "‡∏•‡∏¥‡∏™‡∏ï‡πå" ‡∏Ç‡∏≠‡∏á‡πÇ‡∏ô‡πâ‡∏ï‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ n ‡πÄ‡∏™‡∏°‡∏≠ #}
  {% for n in notes %}
  <div class="note-card">
    <a href="{{ url_for('note_detail', note_id=n.id) }}" class="note-link">
      <div class="note-thumbnail">
        <span class="file-icon">üìÑ</span>
        <p class="file-type">{{ n.filename.rsplit('.', 1)[1] | upper }}</p>
      </div>
      <div class="note-details">
        <p class="note-title">{{ n.title or n.subject }}</p>
        <p class="note-branch">{{ n.faculty }}</p>
      </div>
    </a>

    <div class="card-actions">
      <a class="chip ghost" href="{{ url_for('note_detail', note_id=n.id) }}">‡∏≠‡πà‡∏≤‡∏ô</a>

      <button
        class="chip like"
        data-like="{{ n.id }}"
        data-liked="{{ '1' if (n.liked|default(false)) else '0' }}"
      >
        {% if n.liked|default(false) %}‚ù§Ô∏è{% else %}ü§ç{% endif %} ‡πÉ‡∏à
        (<span class="like-count">{{ n.like_count }}</span>)
      </button>

      <button class="chip warn" data-report="{{ n.id }}">‚ö†Ô∏è ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>

      {% if n.uploader == session['student_id'] %}
      <form action="{{ url_for('delete_note', note_id=n.id) }}" method="post" class="inline-delete-form">
  <button type="submit" class="chip danger">‚úñ ‡∏•‡∏ö</button>
</form>
      {% endif %}
    </div>
  </div>
  {% else %}
    <p class="empty-message">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ô‡πâ‡∏ï‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏•‡∏≠‡∏á‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ô‡πâ‡∏ï" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏î‡∏π‡∏™‡∏¥!</p>
  {% endfor %}
</div>

{% endblock %}
